<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>编码测试页面</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .result {
            background: #f8f9fa;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 14px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .error {
            color: #dc3545;
        }
        .success {
            color: #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧪 编码问题调试页面</h1>
        <p>这个页面用于测试中文编码问题</p>

        <div class="test-section">
            <h3>📸 相册API测试</h3>
            <button onclick="testAlbums()">测试相册数据</button>
            <div id="albums-result" class="result"></div>
        </div>

        <div class="test-section">
            <h3>📝 笔记API测试</h3>
            <button onclick="testNotes()">测试笔记数据</button>
            <div id="notes-result" class="result"></div>
        </div>

        <div class="test-section">
            <h3>✅ 待办事项API测试</h3>
            <button onclick="testTodos()">测试待办数据</button>
            <div id="todos-result" class="result"></div>
        </div>

        <div class="test-section">
            <h3>🔍 字符编码分析</h3>
            <button onclick="analyzeEncoding()">分析编码问题</button>
            <div id="encoding-result" class="result"></div>
        </div>
    </div>

    <script>
        async function testAlbums() {
            const result = document.getElementById('albums-result');
            try {
                const response = await fetch('https://c0a45d30.baoandkai.pages.dev/api/albums');
                const data = await response.json();
                
                result.innerHTML = '📊 相册数据：\n';
                result.innerHTML += `📁 相册数量: ${data.length}\n`;
                
                data.forEach(album => {
                    result.innerHTML += `\n📸 ${album.name} (${album.photos?.length || 0}张照片)\n`;
                    result.innerHTML += `   描述: ${album.description || '无描述'}\n`;
                    result.innerHTML += `   创建时间: ${album.created_at}\n`;
                });
                
                result.className = 'result success';
            } catch (error) {
                result.innerHTML = '❌ 获取相册数据失败: ' + error.message;
                result.className = 'result error';
            }
        }

        async function testNotes() {
            const result = document.getElementById('notes-result');
            try {
                const response = await fetch('https://c0a45d30.baoandkai.pages.dev/api/notes');
                const data = await response.json();
                
                result.innerHTML = '📝 笔记数据：\n';
                result.innerHTML += `📝 笔记数量: ${data.length}\n`;
                
                data.forEach(note => {
                    result.innerHTML += `\n💭 ${note.content}\n`;
                    result.innerHTML += `   颜色: ${note.color}\n`;
                    result.innerHTML += `   创建时间: ${note.created_at}\n`;
                });
                
                result.className = 'result success';
            } catch (error) {
                result.innerHTML = '❌ 获取笔记数据失败: ' + error.message;
                result.className = 'result error';
            }
        }

        async function testTodos() {
            const result = document.getElementById('todos-result');
            try {
                const response = await fetch('https://c0a45d30.baoandkai.pages.dev/api/todos');
                const data = await response.json();
                
                result.innerHTML = '✅ 待办事项数据：\n';
                result.innerHTML += `📋 待办数量: ${data.data.length}\n`;
                
                data.data.forEach(todo => {
                    result.innerHTML += `\n🎯 ${todo.title}\n`;
                    result.innerHTML += `   描述: ${todo.description}\n`;
                    result.innerHTML += `   状态: ${todo.status}\n`;
                });
                
                result.className = 'result success';
            } catch (error) {
                result.innerHTML = '❌ 获取待办数据失败: ' + error.message;
                result.className = 'result error';
            }
        }

        function analyzeEncoding() {
            const result = document.getElementById('encoding-result');
            const testStrings = [
                '测试相册',
                '杨子恺的27岁生日', 
                '包包的25岁生日',
                'ååæ³æ·»å äºä»ä¹åå®¹å¢',
                'ç»ååä¹°LV!'
            ];
            
            result.innerHTML = '🔍 编码分析：\n';
            testStrings.forEach(str => {
                result.innerHTML += `\n"${str}"\n`;
                result.innerHTML += `   UTF-8编码: ${encodeURIComponent(str)}\n`;
                result.innerHTML += `   字符长度: ${str.length}\n`;
            });
            
            result.className = 'result';
        }

        // 页面加载时自动测试
        window.addEventListener('load', () => {
            testAlbums();
            testNotes();
            testTodos();
        });
    </script>
</body>
</html>